<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>-åä¸œåŒ–å·¥åŸæ–™ä»Šæ—¥ä»·æ ¼-</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; }
        h1 { text-align: center; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        tr:hover { background-color: #f5f5f5; }
        .status-normal { color: green; }
        .status-fluctuate { color: orange; }
        .status-exceed { color: red; }
        .market-update h2 { text-align: center; }
        .market-update { margin-top: 20px; }
        .update-time, .data-sources { margin-top: 10px; font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>-åä¸œåŒ–å·¥åŸæ–™ä»Šæ—¥ä»·æ ¼-</h1>
        <table>
            <thead>
                <tr>
                    <th>æŒ‡æ ‡åç§°</th>
                    <th>æ•°æ®ä¸å˜åŒ–</th>
                    <th>çŠ¶æ€</th>
                </tr>
            </thead>
            <tbody id="priceTable">
                <tr>
                    <td>äºŒç”˜é†‡ (å…ƒ/å¨)</td>
                    <td id="deg-price">4570 +5</td>
                    <td><span class="status-normal">âœ”ï¸ æ­£å¸¸</span></td>
                </tr>
                <tr>
                    <td>é—´äºŒé†‡ (å…ƒ/å¨)</td>
                    <td id="mpg-price">6620 -30</td>
                    <td><span class="status-fluctuate">âš ï¸ æ³¢åŠ¨</span></td>
                </tr>
                <tr>
                    <td>åŒç¯æˆŠäºŒçƒ¯ (å…ƒ/å¨)</td>
                    <td id="dcpd-price">5820 -80</td>
                    <td><span class="status-exceed">ğŸš« è¶…é™</span></td>
                </tr>
                <tr>
                    <td>æ–°æˆŠäºŒé†‡ (å…ƒ/å¨)</td>
                    <td id="npd-price">11590 +10</td>
                    <td><span class="status-normal">âœ”ï¸ æ­£å¸¸</span></td>
                </tr>
                <tr>
                    <td>UPR (å…ƒ/å¨)</td>
                    <td id="upr-price">9105 +5</td>
                    <td><span class="status-normal">âœ”ï¸ æ­£å¸¸</span></td>
                </tr>
                <tr>
                    <td>çŸ³æ²¹ç„¦ (å…ƒ/å¨)</td>
                    <td id="pc-price">7415 +35</td>
                    <td><span class="status-fluctuate">âš ï¸ æ³¢åŠ¨</span></td>
                </tr>
            </tbody>
        </table>
        <div class="market-update">
            <h2>ä»Šæ—¥å¸‚åœºåŠ¨æ€æ›´æ–°</h2>
            <ul id="marketUpdate">
                <li>åŸæ²¹å‡äº§åè®®å¯èƒ½ç»§ç»­å½±å“æ–°æˆŠäºŒé†‡ä»·æ ¼ï¼šOPEC+ï¼ˆçŸ³æ²¹è¾“å‡ºå›½ç»„ç»‡åŠå…¶ç›Ÿå‹ï¼‰ä¸ºåº”å¯¹å…¨çƒèƒ½æºå¸‚åœºæ³¢åŠ¨ï¼Œè®¡åˆ’åœ¨2025å¹´ç»§ç»­å®æ–½åŸæ²¹å‡äº§åè®®ï¼Œé¢„è®¡æ¯æ—¥å‡äº§çº¦100ä¸‡æ¡¶ï¼Œä»¥ç¨³å®šæ²¹ä»·ã€‚æ–°æˆŠäºŒé†‡ä½œä¸ºçŸ³åŒ–ä¸‹æ¸¸äº§å“ï¼Œå…¶ç”Ÿäº§æˆæœ¬å—åŸæ²¹ä»·æ ¼æ³¢åŠ¨å½±å“è¾ƒå¤§ï¼Œå‡äº§å¯èƒ½æ¨é«˜åŸæ–™æˆæœ¬ã€‚</li>
                <li>äºŒç”˜é†‡éœ€æ±‚å—é˜»ï¼Œæ¬§ç¾ç°è´§ç´§å¼ åŠ å‰§ï¼šäºŒç”˜é†‡éœ€æ±‚å—é˜»ä¸»è¦å› æ¬§ç¾åœ°åŒºå»ºç­‘å’Œæ±½è½¦è¡Œä¸šæ”¾ç¼“ï¼Œå—åˆ°é«˜é€šèƒ€ã€åˆ©ç‡ä¸Šå‡åŠç»æµä¸ç¡®å®šæ€§å½±å“ã€‚å åŠ æ¸¯å£è¿è¾“ç“¶é¢ˆï¼ˆå¦‚åŠ æ‹¿å¤§æ¸¯å£ç½¢å·¥ï¼‰ï¼Œæ¬§ç¾ç°è´§ä¾›åº”å‡å°‘ï¼Œåº“å­˜å‹åŠ›åŠ å‰§ã€‚</li>
                <li>ä¸­å›½åŒ–å·¥ç”Ÿäº§ç‡å¢é•¿å‡ºå‚æ–°è§„å¼•å‘å¸‚åœºè¿›ä¸€æ­¥æ³¢åŠ¨ï¼šä¸­å›½æ”¿åºœä¸ºå®ç°ç¢³è¾¾å³°ç›®æ ‡ï¼Œ2025å¹´å‘å¸ƒæ–°è§„ï¼Œè¦æ±‚åŒ–å·¥ä¼ä¸šæå‡ç”Ÿäº§æ•ˆç‡å¹¶é™åˆ¶é«˜è€—èƒ½å·¥å‚äº§èƒ½ï¼Œè®¾å®šæ–°ç‚¼æ²¹å‚æœ€ä½è§„æ¨¡ï¼Œå¹¶ç¦æ­¢å°å‹åŸæ²¹åŠ å·¥å‚ä»¥åŒ–å­¦å“åä¹‰è¿è¥ã€‚ä¼ä¸šéœ€è°ƒæ•´ç”Ÿäº§ç»“æ„ï¼ŒçŸ­æœŸå†…å¸‚åœºä¾›åº”æ³¢åŠ¨åŠ å‰§ã€‚</li>
            </ul>
        </div>
        <div class="update-time" id="updateTime">æ•°æ®æ›´æ–°æ—¶é—´ï¼š2025-05-20 20:24</div>
        <div class="data-sources" id="dataSources">æ•°æ®æ¥æºï¼šé‡‘è”åˆ› (JLC.com), éš†ä¼—èµ„è®¯ (Lubricant Oil China), ICIS (ICIS.com), S&P Global Commodity Insights, ä¸­å›½å›½å®¶ç»Ÿè®¡å±€ (National Bureau of Statistics of China)</div>
    </div>

    <script>
        // æ›´æ–°æ—¥æœŸå’Œæ—¶é—´
        function updateDateTime() {
            const now = new Date();
            document.getElementById('updateTime').innerText = `æ•°æ®æ›´æ–°æ—¶é—´ï¼š${now.toLocaleString('zh-CN')}`;
        }

        // æ¨¡æ‹Ÿæ¯æ—¥æ›´æ–°é€»è¾‘ï¼ˆéœ€æ›¿æ¢ä¸ºå®é™…APIè°ƒç”¨ï¼‰
        function fetchUpdatedData() {
            const now = new Date();
            const today = now.toLocaleDateString('zh-CN');
            const lastUpdate = localStorage.getItem('lastUpdate');

            if (!lastUpdate || lastUpdate !== today) {
                // API æ¥å…¥ï¼šè”ç³»é‡‘è”åˆ› (JLC.com) æˆ– ICIS è·å– API æ–‡æ¡£
                // ç¤ºä¾‹ï¼šä½¿ç”¨ fetch API è°ƒç”¨é‡‘è”åˆ›æ•°æ®
                // fetch('https://api.jlc.com/chemicals?date=2025-05-20&api_key=YOUR_API_KEY')
                //   .then(response => response.json())
                //   .then(data => {
                //       document.getElementById('deg-price').innerText = `${data.deg.price} ${data.deg.change}`;
                //       // ç±»ä¼¼æ›´æ–°å…¶ä»–åŸæ–™æ•°æ®
                //   })
                //   .catch(error => console.error('API è°ƒç”¨å¤±è´¥:', error));

                // å¼‚å¸¸æ£€æµ‹ï¼šéªŒè¯æ•°æ®ä¸€è‡´æ€§
                const validateData = (data) => {
                    const thresholds = {
                        'deg-price': [4000, 5000],
                        'mpg-price': [6000, 7000],
                        'dcpd-price': [5000, 6000],
                        'npd-price': [10000, 13000],
                        'upr-price': [8000, 10000],
                        'pc-price': [6000, 8000]
                    };
                    for (let [id, value] of Object.entries(data)) {
                        const [min, max] = thresholds[id];
                        const price = parseFloat(value.split(' ')[0]);
                        if (price < min || price > max) {
                            console.warn(`å¼‚å¸¸æ£€æµ‹ï¼š${id} ä»·æ ¼ ${price} è¶…å‡ºåˆç†èŒƒå›´ [${min}, ${max}]`);
                            // å¯é€‰æ‹©ä¸¢å¼ƒæˆ–æ ‡è®°å¼‚å¸¸æ•°æ®
                        }
                    }
                };

                // æ¨¡æ‹Ÿæ•°æ®ï¼ˆåŸºäºæ¯”å¯¹åçš„æ•°æ®ï¼‰
                const sampleData = {
                    'deg-price': '4570 +5',
                    'mpg-price': '6620 -30',
                    'dcpd-price': '5820 -80',
                    'npd-price': '11590 +10',
                    'upr-price': '9105 +5',
                    'pc-price': '7415 +35'
                };
                const sampleUpdates = [
                    'åŸæ²¹å‡äº§åè®®å¯èƒ½ç»§ç»­å½±å“æ–°æˆŠäºŒé†‡ä»·æ ¼ï¼šOPEC+ï¼ˆçŸ³æ²¹è¾“å‡ºå›½ç»„ç»‡åŠå…¶ç›Ÿå‹ï¼‰ä¸ºåº”å¯¹å…¨çƒèƒ½æºå¸‚åœºæ³¢åŠ¨ï¼Œè®¡åˆ’åœ¨2025å¹´ç»§ç»­å®æ–½åŸæ²¹å‡äº§åè®®ï¼Œé¢„è®¡æ¯æ—¥å‡äº§çº¦100ä¸‡æ¡¶ï¼Œä»¥ç¨³å®šæ²¹ä»·ã€‚æ–°æˆŠäºŒé†‡ä½œä¸ºçŸ³åŒ–ä¸‹æ¸¸äº§å“ï¼Œå…¶ç”Ÿäº§æˆæœ¬å—åŸæ²¹ä»·æ ¼æ³¢åŠ¨å½±å“è¾ƒå¤§ï¼Œå‡äº§å¯èƒ½æ¨é«˜åŸæ–™æˆæœ¬ã€‚',
                    'äºŒç”˜é†‡éœ€æ±‚å—é˜»ï¼Œæ¬§ç¾ç°è´§ç´§å¼ åŠ å‰§ï¼šäºŒç”˜é†‡éœ€æ±‚å—é˜»ä¸»è¦å› æ¬§ç¾åœ°åŒºå»ºç­‘å’Œæ±½è½¦è¡Œä¸šæ”¾ç¼“ï¼Œå—åˆ°é«˜é€šèƒ€ã€åˆ©ç‡ä¸Šå‡åŠç»æµä¸ç¡®å®šæ€§å½±å“ã€‚å åŠ æ¸¯å£è¿è¾“ç“¶é¢ˆï¼ˆå¦‚åŠ æ‹¿å¤§æ¸¯å£ç½¢å·¥ï¼‰ï¼Œæ¬§ç¾ç°è´§ä¾›åº”å‡å°‘ï¼Œåº“å­˜å‹åŠ›åŠ å‰§ã€‚',
                    'ä¸­å›½åŒ–å·¥ç”Ÿäº§ç‡å¢é•¿å‡ºå‚æ–°è§„å¼•å‘å¸‚åœºè¿›ä¸€æ­¥æ³¢åŠ¨ï¼šä¸­å›½æ”¿åºœä¸ºå®ç°ç¢³è¾¾å³°ç›®æ ‡ï¼Œ2025å¹´å‘å¸ƒæ–°è§„ï¼Œè¦æ±‚åŒ–å·¥ä¼ä¸šæå‡ç”Ÿäº§æ•ˆç‡å¹¶é™åˆ¶é«˜è€—èƒ½å·¥å‚äº§èƒ½ï¼Œè®¾å®šæ–°ç‚¼æ²¹å‚æœ€ä½è§„æ¨¡ï¼Œå¹¶ç¦æ­¢å°å‹åŸæ²¹åŠ å·¥å‚ä»¥åŒ–å­¦å“åä¹‰è¿è¥ã€‚ä¼ä¸šéœ€è°ƒæ•´ç”Ÿäº§ç»“æ„ï¼ŒçŸ­æœŸå†…å¸‚åœºä¾›åº”æ³¢åŠ¨åŠ å‰§ã€‚'
                ];

                // æ•°æ®éªŒè¯å’Œæ›´æ–°
                validateData(sampleData);
                for (const [id, value] of Object.entries(sampleData)) {
                    document.getElementById(id).innerText = value;
                }
                document.getElementById('marketUpdate').innerHTML = sampleUpdates.map(item => `<li>${item}</li>`).join('');
                document.getElementById('dataSources').innerText = 'æ•°æ®æ¥æºï¼šé‡‘è”åˆ› (JLC.com), éš†ä¼—èµ„è®¯ (Lubricant Oil China), ICIS (ICIS.com), S&P Global Commodity Insights, ä¸­å›½å›½å®¶ç»Ÿè®¡å±€ (National Bureau of Statistics of China)';

                // ä¿å­˜æœ€åæ›´æ–°æ—¶é—´
                localStorage.setItem('lastUpdate', today);
            }
        }

        // æ¯å¤©è¿è¡Œä¸€æ¬¡æ›´æ–°ï¼ˆæµ‹è¯•ç”¨æ¯åˆ†é’Ÿæ£€æŸ¥ï¼‰
        setInterval(() => {
            const now = new Date();
            if (now.getHours() === 0 && now.getMinutes() === 0) {
                fetchUpdatedData();
            }
        }, 60000); // æ¯åˆ†é’Ÿæ£€æŸ¥ï¼Œä¾¿äºæµ‹è¯•

        // åˆå§‹åŠ è½½
        updateDateTime();
        fetchUpdatedData();
    </script>
</body>
</html>